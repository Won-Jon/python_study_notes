# 1.2 字符串

## 1. 字符串的创建

* **使用单引号或双引号：**

    ```python
    s1 = 'Hello'
    s2 = "World"
    ```

* **使用三引号（多行字符串）：**

    ```python
    s3 = '''This is a
    multiline string'''
    s4 = """This is also a
    multiline string"""
    ```

* **空字符串：**

    ```python
    empty_string = ""
    ```

## 2. 字符串的基本操作

* **字符串连接（Concatenation）：**

    ```python
    s1 = "Hello"
    s2 = "World"
    result = s1 + " " + s2  # "Hello World"
    ```

* **字符串重复：**

    ```python
    s = "abc"
    repeated_string = s * 3  # "abcabcabc"
    ```

* **字符串长度：**

    ```python
    s = "Python"
    length = len(s)  # 6
    ```

* **字符串索引：**  字符串可以像列表一样通过索引访问单个字符。 索引从 0 开始。

    ```python
    s = "Python"
    first_char = s[0]  # "P"
    last_char = s[-1] # "n" (负索引，从末尾开始计数)
    ```

* **字符串切片：**

    `str[start:end:step]`是指截取从第 ` start ` 到第 ` end ` 的字符，并每隔 ` step ` 个字符取一个。并且每一个都支持负索引。默认的 `start` 是 0，默认的 `end` 是字符串的长度，默认的 `step` 是 1。

    ```python
    s = "Python"
    sub_string = s[1:4]  # "yth" (从索引 1 开始，到索引 4 之前结束)
    sub_string = s[:3]   # "Pyt" (从开头到索引 3 之前结束)
    sub_string = s[2:]   # "thon" (从索引 2 到结尾)
    sub_string = s[:]    # "Python" (复制整个字符串)
    sub_string = s[::2]  # "Pto" (每隔一个字符取一个)
    sub_string = s[::-1] # "nohtyP" (反转字符串)
    ```

## 3. 字符串格式化

* **`%` 格式化（旧式）：**

    ```python
    name = "Alice"
    age = 30
    message = "My name is %s and I am %d years old." % (name, age)
    print(message)  # "My name is Alice and I am 30 years old."

    # 其他常用格式化符号：
    # %s - 字符串
    # %d - 整数
    # %f - 浮点数
    # %x - 十六进制整数
    ```

    虽然 `%` 格式化仍然可用，但推荐使用更现代的 `.format()` 和 f-strings。

* **`.format()` 格式化：**

    ```python
    name = "Bob"
    age = 25
    message = "My name is {} and I am {} years old.".format(name, age)
    print(message)  # "My name is Bob and I am 25 years old."

    # 通过索引指定参数顺序：
    message = "My name is {1} and I am {0} years old.".format(age, name)
    print(message)  # "My name is Bob and I am 25 years old."

    # 通过关键字参数传递：
    message = "My name is {name} and I am {age} years old.".format(name="Charlie", age=35)
    print(message)  # "My name is Charlie and I am 35 years old."

    # 格式化数值：
    pi = 3.1415926
    formatted_pi = "Pi is approximately {:.2f}".format(pi)  # "Pi is approximately 3.14"
    ```

* **f-strings (formatted string literals)：**  Python 3.6 引入。  最简洁、最易读的方式。

    ```python
    name = "David"
    age = 40
    message = f"My name is {name} and I am {age} years old."
    print(message)  # "My name is David and I am 40 years old."

    # 可以在 f-string 中直接执行表达式：
    x = 5
    y = 10
    result = f"The sum of {x} and {y} is {x + y}."
    print(result)  # "The sum of 5 and 10 is 15."

    # 格式化数值：
    pi = 3.1415926
    formatted_pi = f"Pi is approximately {pi:.2f}"  # "Pi is approximately 3.14"
    ```

## 4. 字符串的常用方法

以下列出部分常用的字符串方法。  字符串是不可变的，这些方法通常返回一个新的字符串，而不是修改原始字符串。

* **大小写转换：**

    ```python
    s = "Hello World"
    lower_case = s.lower()  # "hello world"
    upper_case = s.upper()  # "HELLO WORLD"
    title_case = s.title()  # "Hello World" (每个单词首字母大写)
    swap_case = s.swapcase() # "hELLO wORLD" (大小写互换)
    ```

* **判断字符串内容：**

    ```python
    s = "Python123"
    is_alpha = s.isalpha()  # False (包含数字)
    is_digit = s.isdigit()  # False (包含字母)
    is_alnum = s.isalnum()  # True (字母或数字)
    is_lower = s.islower()  # False
    is_upper = s.isupper()  # False
    is_title = s.istitle()  # False
    is_space = "  ".isspace() # True (只包含空格)
    is_numeric = "12345".isnumeric() # True (Unicode 数字 characters)
    is_decimal = "12345".isdecimal() # True (用于形成十进制数的字符)

    ```

* **查找子字符串：**

    ```python
    s = "Hello World"
    index = s.find("World")  # 6 (返回子字符串的起始索引，如果不存在则返回 -1)
    index = s.index("World")  # 6 (与 find 类似，但如果子字符串不存在则抛出 ValueError 异常)
    count = s.count("l")    # 3 (统计子字符串出现的次数)
    starts_with = s.startswith("Hello")  # True
    ends_with = s.endswith("World")    # True
    ```

* **替换子字符串：**

    ```python
    s = "Hello World"
    new_string = s.replace("World", "Python")  # "Hello Python"
    new_string = s.replace("l", "L", 2)  # "HeLLo World" (只替换前 2 个)
    ```

* **分割字符串：**

    ```python
    s = "Hello,World,Python"
    parts = s.split(",")  # ['Hello', 'World', 'Python']

    s = "  Hello   World  "
    parts = s.split()   # ['Hello', 'World'] (默认按空格分割，并去除开头和结尾的空格)

    s = "Line1\nLine2\nLine3"
    lines = s.splitlines() # ['Line1', 'Line2', 'Line3'] (按行分割)
    ```

* **连接字符串：**

    ```python
    parts = ["Hello", "World", "Python"]
    s = " ".join(parts)  # "Hello World Python"
    s = ",".join(parts)  # "Hello,World,Python"
    ```

* **去除空白字符：**

    ```python
    s = "  Hello World  "
    stripped_string = s.strip()  # "Hello World" (去除开头和结尾的空格)
    lstripped_string = s.lstrip() # "Hello World  " (去除开头的空格)
    rstripped_string = s.rstrip() # "  Hello World" (去除结尾的空格)
    ```

* **填充字符串：**

    ```python
    s = "abc"
    padded_string = s.zfill(5)  # "00abc" (用 0 填充到指定长度，只适用于数字字符串)
    padded_string = s.center(10, "*") # "***abc****" (居中，用 * 填充)
    padded_string = s.ljust(10, "-")  # "abc-------" (左对齐，用 - 填充)
    padded_string = s.rjust(10, "+")  # "+++++++abc" (右对齐，用 + 填充)
    ```

## 5. 字符串编码与解码

* **编码（encode）：** 将字符串转换为字节序列

    ```python
    s = "你好"
    encoded_utf8 = s.encode("utf-8")    # b'\xe4\xbd\xa0\xe5\xa5\xbd' (UTF-8 编码)
    encoded_gbk  = s.encode("gbk")     # b'\xc4\xe3\xba\xc3' (GBK 编码)
    ```

* **解码（decode）：** 将字节序列转换为字符串

    ```python
    encoded_utf8 = b'\xe4\xbd\xa0\xe5\xa5\xbd'
    decoded_string = encoded_utf8.decode("utf-8")  # "你好"

    encoded_gbk  = b'\xc4\xe3\xba\xc3'
    decoded_string = encoded_gbk.decode("gbk")   # "你好"
    ```

    **注意事项：** 使用正确的编码格式进行解码非常重要，否则可能导致乱码。

## 6. 字符串的高级应用

* **正则表达式（`re` 模块）：** 用于模式匹配和字符串搜索、替换等。

    ```python
    import re

    s = "My phone number is 123-456-7890"
    pattern = r"\d{3}-\d{3}-\d{4}"  # 匹配电话号码的正则表达式
    match = re.search(pattern, s)

    if match:
        print("Phone number found:", match.group())  # "123-456-7890"

    new_string = re.sub(pattern, "XXX-XXX-XXXX", s)
    print(new_string) # My phone number is XXX-XXX-XXXX
    ```

* **字符串模板（`string.Template`）：**  用于更安全、更灵活的字符串替换。

    ```python
    from string import Template

    template = Template("My name is $name and I am $age years old.")
    message = template.substitute(name="Eve", age=28)
    print(message)  # "My name is Eve and I am 28 years old."

    # Safe substitution:  如果找不到对应的变量，不会抛出异常
    message = template.safe_substitute(name="Eve")
    print(message) # "My name is Eve and I am $age years old."
    ```
