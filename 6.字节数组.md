# Python字节数组

## 字节数组 (bytearray) 详解

字节数组（`bytearray`）是 Python 中一种**可变的**字节序列数据类型。 它可以被认为是字节串（`bytes`）的可变版本。 简单来说，你可以在创建后修改字节数组的内容。

### 1. 字节数组的特点

* **可变序列：**  与字节串（`bytes`）不同，字节数组的内容可以被修改，包括添加、删除和修改元素。
* **字节：**  字节数组中的每个元素都是一个字节，即一个介于 0 到 255 之间的整数。
* **序列：** 字节数组如同字节串一样，可以如同列表或元组一般进行索引和切片。

### 2.  与字节串(bytes)的区别

| 特性      | 字节串（bytes） | 字节数组（bytearray） |
| ------- | -------- | ---------- |
| 可变性    | 不可变     | 可变       |
| 应用场景  | 常用于存储和表示静态二进制数据  | 常用于需要动态修改的二进制数据   |

### 3. 创建字节数组

* **`bytearray()` 构造函数：**

  * 从字节串创建：

        ```python
        b = b'hello'
        ba = bytearray(b)
        ```

  * 从可迭代对象创建：

        ```python
        l = [72, 101, 108, 108, 111]  # ASCII 码
        ba = bytearray(l)  # bytearray(b'Hello')
        ```

  * 指定长度创建（全部初始化为 0）：

        ```python
        ba = bytearray(5)  # bytearray(b'\x00\x00\x00\x00\x00')
        ```

* **`bytearray.fromhex()`：**  从十六进制字符串创建。

        ```python
        ba = bytearray.fromhex('48656c6c6f')  # bytearray(b'Hello')
        ```

### 4. 字节数组的操作

由于字节数组是可变的，所以可以进行原地修改。

* **索引和切片：** 索引访问单个字节（返回整数），切片返回新的字节数组。

        ```python
        ba = bytearray(b'hello')
        print(ba[0])    # 104 (h 的 ASCII 码)
        print(ba[1:3])  # bytearray(b'el') # 起始索引（包含），到结束索引（不包含）
        ```

    **注意：** 可以通过索引直接修改字节数组中的元素。

        ```python
        ba[0] = 74  # 修改第一个字节为 'J'
        print(ba)    # bytearray(b'Jello')
        ```

* **拼接：** 使用 `+` 运算符进行拼接 （返回新的字节数组）。

        ```python
        ba1 = bytearray(b'hello')
        ba2 = bytearray(b' world')
        ba3 = ba1 + ba2  # bytearray(b'hello world')
        ```

* **修改元素：**

  * `append(byte)`： 在末尾添加一个字节 (整数)。

  * `extend(iterable)`： 从一个可迭代对象（例如，另一个字节数组、列表等）追加字节。

  * `insert(index, byte)`： 在指定索引处插入一个字节。

  * `pop(index=-1)`：  删除并返回指定索引的字节（默认为最后一个）。

  * `remove(byte)`：  删除第一个匹配的字节。

  * `clear()`： 清空字节数组。

* **删除元素：**

  * `del ba[index]`：  删除指定索引处的字节。

  * `del ba[start:end]`： 删除指定范围内的字节。

* **其他常用方法：**

  * `find(), replace(), startswith(), endswith(), lower(), upper(), strip(), reverse()`

### 5. 编码与解码

字节数组也可以编码和解码，用法与字节串相同。

    ```python
    ba = bytearray(b'\xe4\xbd\xa0\xe5\xa5\xbd')
    s = ba.decode('utf-8')  # 解码
    print(s)

    s = "你好"
    ba = bytearray(s.encode('utf-8')) # 编码
    ```

### 6. 使用场景

* **数据缓冲区：**  用于存储和修改从网络或文件中读取的数据。
* **图像处理：**  用于操作图像的像素数据。
* **加密解密：**  用于修改加密算法中的字节数据。
* **底层编程：** 与操作系统或硬件进行交互，需要修改底层数据时。

### 7. 示例

    ```python
    # 创建一个字节数组
    ba = bytearray(b'hello')

    # 修改第一个字节
    ba[0] = ord('J')  # 将 'h' 修改为 'J'，使用 ord() 获取字符的 ASCII 码
    print(ba)        # bytearray(b'Jello')

    # 添加一个字节
    ba.append(32)   # 添加一个空格 (ASCII 码 32)
    print(ba)  # bytearray(b'Jello ')

    # 追加一个字节串
    ba.extend(b'world')
    print(ba)        # bytearray(b'Jello world')

    # 删除第一个字节
    del ba[0]
    print(ba)        # bytearray(b'ello world')
    ```

### 8.  总结

字节数组为我们提供了在字节级别上操作数据的能力。 适用于进行底层数据处理、网络编程和需要修改二进制数据的场景。  通过 bytearray,  你可以方便地操作二进制数据，而不需要每次都创建新的对象，从而提高性能。
