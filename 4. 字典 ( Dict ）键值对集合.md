# 字典 （ Dict ）键值对集合

### 一、字典是什么？

字典是 Python 中一种**可变的、无序的**键值对（Key-Value Pair）集合。

* **键值对**：每个元素都由两部分组成，一个唯一的 **键（Key）** 和一个对应的 **值（Value）**，中间用冒号 `:` 分隔。
* **无序**：在 Python 3.6 之前的版本中，字典元素是无序的，即元素顺序与添加顺序无关。从 Python 3.7 开始，**字典会保持元素的插入顺序**，但这仍然被认为是其实现细节，我们通常还是将其视为无序集合来处理。
* **可变**：创建后，可以添加、删除、修改其中的键值对。
* **键必须唯一且不可变**：键（Key）不能重复，并且必须是不可变的数据类型，如整数、浮点数、字符串、元组（但元组内不能有可变元素）。**列表、字典、集合**等可变类型不能作为键。
* **值可以是任意类型**：值（Value）可以是任何数据类型，如数字、字符串、列表，甚至是另一个字典。

---

### 二、如何创建字典？

#### 1. 使用花括号 `{}` （最常用）

直接在大括号 `{}` 中放置用逗号分隔的键值对。

```python
# 创建一个空字典
empty_dict = {}

# 创建一个有数据的字典
my_dict = {"name": "Alice", "age": 25, "city": "New York"}
print(my_dict) # 输出: {'name': 'Alice', 'age': 25, 'city': 'New York'}
```

#### 2. 使用 `dict()` 构造函数

可以用关键字参数或包含键值元组的列表/元组来创建。

```python
# 使用关键字参数
dict1 = dict(name="Bob", age=30, city="London")
print(dict1) # 输出: {'name': 'Bob', 'age': 30, 'city': 'London'}

# 使用可迭代对象（列表内嵌元组）
dict2 = dict([("name", "Charlie"), ("age", 35), ("city", "Paris")])
print(dict2) # 输出: {'name': 'Charlie', 'age': 35, 'city': 'Paris'}
```

---

### 三、如何访问字典中的值？

通过**键**来访问其对应的**值**，使用方括号 `[]` 语法。

```python
my_dict = {"name": "Alice", "age": 25, "city": "New York"}

# 1. 使用方括号 [] （如果键不存在，会抛出 KeyError 异常）
print(my_dict["name"]) # 输出: Alice

# 2. 使用 get() 方法 （更安全，键不存在时返回 None 或指定的默认值）
print(my_dict.get("age"))    # 输出: 25
print(my_dict.get("country")) # 输出: None
print(my_dict.get("country", "USA")) # 输出: USA (提供了默认值)
```

---

### 四、如何操作字典（增、删、改、查）？

#### 1. 添加/修改元素

```python
my_dict = {"name": "Alice", "age": 25}

# 修改元素：直接给已存在的键赋值
my_dict["age"] = 26
print(my_dict) # 输出: {'name': 'Alice', 'age': 26}

# 添加新元素：给不存在的键赋值
my_dict["city"] = "New York"
print(my_dict) # 输出: {'name': 'Alice', 'age': 26, 'city': 'New York'}
```

#### 2. 删除元素

```python
my_dict = {"name": "Alice", "age": 25, "city": "New York"}

# 1. del 语句：删除指定键的元素
del my_dict["city"]
print(my_dict) # 输出: {'name': 'Alice', 'age': 25}

# 2. pop() 方法：删除指定键的元素并返回其值
age = my_dict.pop("age")
print(age)      # 输出: 25
print(my_dict)  # 输出: {'name': 'Alice'}

# 3. popitem() 方法：删除并返回最后插入的键值对（Python 3.7+）
my_dict = {"name": "Alice", "age": 25}
item = my_dict.popitem()
print(item)     # 输出: ('age', 25)
print(my_dict)  # 输出: {'name': 'Alice'}

# 4. clear() 方法：清空整个字典
my_dict.clear()
print(my_dict)  # 输出: {}
```

#### 3. 检查键是否存在

使用 `in` 关键字。

```python
my_dict = {"name": "Alice", "age": 25}
print("name" in my_dict)   # 输出: True
print("city" in my_dict)   # 输出: False
```

---

### 五、如何遍历字典？

字典的遍历非常灵活，可以遍历键、值或键值对。

```python
my_dict = {"name": "Alice", "age": 25, "city": "New York"}

# 1. 遍历所有的键 (默认行为)
for key in my_dict:
    print(key)
# 输出:
# name
# age
# city

# 等价于
for key in my_dict.keys():
    print(key)

# 2. 遍历所有的值
for value in my_dict.values():
    print(value)
# 输出:
# Alice
# 25
# New York

# 3. 同时遍历所有的键和值 (最常用)
for key, value in my_dict.items():
    print(f"Key: {key}, Value: {value}")
# 输出:
# Key: name, Value: Alice
# Key: age, Value: 25
# Key: city, Value: New York
```

---

### 六、字典的常用方法

| 方法 | 描述 |
| :--- | :--- |
| `dict.clear()` | 移除字典中的所有元素 |
| `dict.copy()` | 返回字典的一个浅拷贝 |
| `dict.get(key[, default])` | 返回指定键的值，如果键不存在则返回默认值 |
| `dict.items()` | 返回一个包含所有（键，值）元组的视图对象 |
| `dict.keys()` | 返回一个包含所有键的视图对象 |
| `dict.values()` | 返回一个包含所有值的视图对象 |
| `dict.pop(key[, default])` | 删除并返回指定键的值，如果键不存在且提供了默认值则返回默认值，否则抛出 KeyError |
| `dict.popitem()` | 删除并返回最后插入的（键，值）对 |
| `dict.update([other])` | 使用另一个字典的键值对更新当前字典 |
| `dict.setdefault(key[, default])` | 如果键存在，返回其值；如果不存在，插入键并设置默认值，返回默认值 |

**`update()` 示例：**

```python
dict1 = {"a": 1, "b": 2}
dict2 = {"b": 3, "c": 4} # 注意键 'b' 重复了
dict1.update(dict2)
print(dict1) # 输出: {'a': 1, 'b': 3, 'c': 4} (dict2 的键值对覆盖和添加到了 dict1)
```

**`setdefault()` 示例：**

```python
my_dict = {"name": "Alice"}
# 键存在，返回对应的值，不做任何操作
value = my_dict.setdefault("name", "Bob")
print(value)    # 输出: Alice
print(my_dict)  # 输出: {'name': 'Alice'}

# 键不存在，插入键值对，并返回默认值
value = my_dict.setdefault("age", 25)
print(value)    # 输出: 25
print(my_dict)  # 输出: {'name': 'Alice', 'age': 25}
```

---

### 七、字典推导式

和列表推导式类似，可以快速生成字典。

**语法：** `{key_expression: value_expression for item in iterable}`

```python
# 创建一个字典，键是数字，键是数字的平方
squares = {x: x**2 for x in range(1, 6)}
print(squares) # 输出: {1: 1, 2: 4, 3: 9, 4: 16, 5: 25}

# 将两个列表合并为一个字典
keys = ['name', 'age', 'city']
values = ['Alice', 25, 'New York']
person_dict = {k: v for k, v in zip(keys, values)}
print(person_dict) # 输出: {'name': 'Alice', 'age': 25, 'city': 'New York'}
```

### 总结

字典是 Python 的基石之一，因其高效的查找速度（通过键直接访问，平均时间复杂度为 O(1)）和灵活的结构，被广泛应用于：

* 表示现实世界的对象（如用户信息、配置设置）
* 作为快速查找表
* 统计计数（例如，统计单词频率）
* JSON 数据的天然映射
